% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/analysis_Enrichment.R
\name{analysis.Enrichment}
\alias{analysis.Enrichment}
\title{Perform and Visualize Cluster Enrichment Analysis}
\usage{
analysis.Enrichment(
  fit.GMM,
  Xclust,
  Xnew,
  seed,
  n.clust = NULL,
  nrep = 100,
  filename = NULL
)
}
\arguments{
\item{fit.GMM}{The fitted GMM object from \code{mclust::Mclust}.}

\item{Xclust}{A data frame containing the data with a \code{class} column for cluster assignments.}

\item{Xnew}{The raw numeric data matrix used for the GMM.}

\item{seed}{The random seed used in the original GMM fit, passed to \code{fit.enrichment} for reproducibility.}

\item{n.clust}{The number of clusters in the model.}

\item{nrep}{The number of permutations for the enrichment test.}

\item{filename}{A base string for the output PDF plot file.}
}
\value{
A list containing:
\item{Xnew}{The original data matrix.}
\item{Xclust2}{The original \code{Xclust} data frame (note: reassignment is commented out in the provided code).}
\item{fit.GMM}{The original fitted GMM object.}
\item{res.enrichment}{The list object returned by \code{fit.enrichment}.}
}
\description{
A wrapper function that runs the enrichment analysis, identifies
significant clusters, and creates a diagnostic plot.
}
\details{
This function orchestrates the cluster validation workflow. It takes a fitted GMM
result and performs the following steps:
\enumerate{
\item Calls \code{fit.enrichment} to conduct the permutation-based statistical test for cluster robustness.
\item Generates a diagnostic "volcano-like" plot, plotting the log-10 p-value against the relative enrichment score (\eqn{\rho_{rel}}). This plot visually separates significant clusters (typically in the upper right, with high enrichment and low p-value) from non-significant ones.
\item Identifies significant clusters (\code{SigCluster}) based on a significance threshold (e.g., p-value < 0.05).
\item Returns a list containing the enrichment results and other relevant model objects for downstream use.
}

The function also contains commented-out code to demonstrate how one might use \code{reassign.enrichment} to create a new, consolidated set of cluster assignments.
}
\seealso{
\code{\link{fit.enrichment}}, \code{\link{reassign.enrichment}}
}
